{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-51e16e06\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  key: 0\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" Heute noch nicht besucht \");\n\nconst _hoisted_3 = {\n  key: 1\n};\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\" Für heute schon alles gerettet \");\n\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, null, -1));\n\nconst _hoisted_6 = {\n  key: 2\n};\n\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\" Hier gibts noch was \");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_card_title = _resolveComponent(\"ion-card-title\");\n\n  const _component_ion_col = _resolveComponent(\"ion-col\");\n\n  const _component_ion_icon = _resolveComponent(\"ion-icon\");\n\n  const _component_ion_label = _resolveComponent(\"ion-label\");\n\n  const _component_ion_chip = _resolveComponent(\"ion-chip\");\n\n  const _component_ion_row = _resolveComponent(\"ion-row\");\n\n  const _component_ion_grid = _resolveComponent(\"ion-grid\");\n\n  const _component_ion_card_header = _resolveComponent(\"ion-card-header\");\n\n  const _component_ion_button = _resolveComponent(\"ion-button\");\n\n  const _component_ion_card_content = _resolveComponent(\"ion-card-content\");\n\n  const _component_ion_card = _resolveComponent(\"ion-card\");\n\n  const _component_ion_content = _resolveComponent(\"ion-content\");\n\n  return _openBlock(), _createBlock(_component_ion_content, null, {\n    default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.spot, item => {\n      return _openBlock(), _createBlock(_component_ion_card, {\n        class: \"card\",\n        key: item.name\n      }, {\n        default: _withCtx(() => [_createVNode(_component_ion_card_header, null, {\n          default: _withCtx(() => [_createVNode(_component_ion_grid, null, {\n            default: _withCtx(() => [_createVNode(_component_ion_row, null, {\n              default: _withCtx(() => [_createVNode(_component_ion_col, null, {\n                default: _withCtx(() => [_createVNode(_component_ion_card_title, {\n                  class: \"title\"\n                }, {\n                  default: _withCtx(() => [_createTextVNode(_toDisplayString(item.name), 1)]),\n                  _: 2\n                }, 1024)]),\n                _: 2\n              }, 1024), _createVNode(_component_ion_col, {\n                class: \"time_chip\"\n              }, {\n                default: _withCtx(() => [_createVNode(_component_ion_chip, null, {\n                  default: _withCtx(() => [_createVNode(_component_ion_icon, {\n                    icon: _ctx.time,\n                    color: \"dark\"\n                  }, null, 8, [\"icon\"]), _createVNode(_component_ion_label, {\n                    onClick: _cache[0] || (_cache[0] = $event => _ctx.check_day())\n                  }, {\n                    default: _withCtx(() => [_createTextVNode(\" Ab \" + _toDisplayString(item.time) + \" Uhr \", 1)]),\n                    _: 2\n                  }, 1024)]),\n                  _: 2\n                }, 1024)]),\n                _: 2\n              }, 1024)]),\n              _: 2\n            }, 1024)]),\n            _: 2\n          }, 1024)]),\n          _: 2\n        }, 1024), _createVNode(_component_ion_card_content, null, {\n          default: _withCtx(() => [_createVNode(_component_ion_grid, null, {\n            default: _withCtx(() => [_createVNode(_component_ion_row, null, {\n              default: _withCtx(() => [_createVNode(_component_ion_col, null, {\n                default: _withCtx(() => [_createElementVNode(\"p\", null, _toDisplayString(item.description), 1)]),\n                _: 2\n              }, 1024)]),\n              _: 2\n            }, 1024), _createVNode(_component_ion_row, null, {\n              default: _withCtx(() => [_createVNode(_component_ion_col, null, {\n                default: _withCtx(() => [item.status == '1' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_ion_button, {\n                  class: \"button\",\n                  expand: \"block\",\n                  color: \"danger\",\n                  onClick: _ctx.presentActionSheet\n                }, {\n                  default: _withCtx(() => [_hoisted_2]),\n                  _: 1\n                }, 8, [\"onClick\"])])) : _createCommentVNode(\"\", true), item.status == '2' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_component_ion_button, {\n                  class: \"button\",\n                  expand: \"block\",\n                  color: \"success\",\n                  onClick: _ctx.presentActionSheet\n                }, {\n                  default: _withCtx(() => [_hoisted_4]),\n                  _: 1\n                }, 8, [\"onClick\"]), _hoisted_5])) : _createCommentVNode(\"\", true), item.status == '3' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_ion_button, {\n                  class: \"button\",\n                  expand: \"block\",\n                  color: \"warning\",\n                  onClick: _ctx.presentActionSheet\n                }, {\n                  default: _withCtx(() => [_hoisted_7]),\n                  _: 1\n                }, 8, [\"onClick\"])])) : _createCommentVNode(\"\", true)]),\n                _: 2\n              }, 1024)]),\n              _: 2\n            }, 1024)]),\n            _: 2\n          }, 1024)]),\n          _: 2\n        }, 1024)]),\n        _: 2\n      }, 1024);\n    }), 128))]),\n    _: 1\n  });\n}","map":{"version":3,"mappings":"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","names":["_createElementVNode","_createBlock","_component_ion_content","_createElementBlock","_Fragment","_renderList","_ctx","item","_component_ion_card","class","key","name","_createVNode","_component_ion_card_header","_component_ion_grid","_component_ion_row","_component_ion_col","_component_ion_card_title","_component_ion_chip","_component_ion_icon","icon","color","_component_ion_label","onClick","_toDisplayString","time","_component_ion_card_content","description","status","_hoisted_1","_component_ion_button","expand","_hoisted_3","_hoisted_5","_hoisted_6"],"sourceRoot":"","sources":["/home/pumuckl/Dokumente/code/ionic/dumpster-diving-ionic/src/views/SpotModal.vue"],"sourcesContent":["<template>\n    <!-- Sheet Modal -->\n        <ion-content> \n            <ion-card \n                class=\"card\" \n                v-for=\"item in spot\" \n                :key=\"item.name\">\n                <ion-card-header>\n                    <ion-grid>\n                        <ion-row>\n                        <ion-col>\n                            <ion-card-title class=\"title\">\n                            {{ item.name }}\n                            </ion-card-title>\n                        </ion-col>\n                        <ion-col class=\"time_chip\">\n                            <ion-chip>\n                                <ion-icon \n                                    :icon=\"time\" \n                                    color=\"dark\">\n                                </ion-icon>\n                                <ion-label\n                                @click=\"check_day()\">\n                                    Ab {{ item.time }} Uhr\n                                </ion-label>\n                            </ion-chip>\n                        </ion-col>\n                        </ion-row>\n                    </ion-grid>\n                </ion-card-header>\n                <ion-card-content>\n                    <ion-grid>\n                        <ion-row>\n                            <ion-col>\n                                <p>\n                                    {{ item.description }}\n                                </p>\n                            </ion-col>\n                        </ion-row>\n                        <ion-row>\n                            <ion-col>\n                                <div\n                                    v-if=\"item.status == '1'\">\n                                    <ion-button \n                                        class=\"button\"\n                                        expand=\"block\" \n                                        color=\"danger\"\n                                        @click=\"presentActionSheet\">\n                                        Heute noch nicht besucht\n                                    </ion-button>\n                                </div>\n                                <div\n                                    v-if=\"item.status == '2'\">\n                                  <ion-button \n                                      class=\"button\"\n                                      expand=\"block\" \n                                      color=\"success\"\n                                      @click=\"presentActionSheet\"\n                                      >\n                                      Für heute schon alles gerettet\n                                  </ion-button>\n                                    <div>\n                                    </div>\n                                </div>\n                                <div\n                                    v-if=\"item.status == '3'\">\n                                  <ion-button \n                                      class=\"button\"\n                                      expand=\"block\" \n                                      color=\"warning\"\n                                      @click=\"presentActionSheet\"\n                                      >\n                                      Hier gibts noch was\n                                  </ion-button>\n                                    \n                                </div>\n                                <!-- //// -->\n                            </ion-col>\n                        </ion-row>\n                    </ion-grid>\n                </ion-card-content>\n            </ion-card>\n        </ion-content>\n</template>\n\n<script>\nimport { defineComponent } from 'vue';\nimport { useCounterStore } from '@/stores/counter'\nimport { supabase } from \"@/supabase\"\nimport { time } from 'ionicons/icons';\nimport { IonContent, \n    IonCard, \n    IonCardContent, \n    IonCardHeader, \n    IonCardTitle, \n    IonButton, \n    actionSheetController,\n    IonIcon,\n    IonLabel,\n    IonChip,\n    IonCol, \n    IonGrid, \n    IonRow } from '@ionic/vue';\n\nexport default defineComponent({\n  name: 'Tab2Page',\n  components: {\n    IonContent,\n    IonCard, \n    IonCardContent, \n    IonCardHeader, \n    IonCardTitle,\n    IonButton,\n    IonIcon,\n    IonLabel,\n    IonChip,\n    IonCol, \n    IonGrid, \n    IonRow\n    },\n  data: () => ({\n    spot: [],\n    time_since_close_value: '',\n    time_since_change_value_millisec: '',\n    time_since_change_value_minutes: '',\n    jetzt_total_minutes: '',\n    last_status_change: '',\n    heute: '',\n    last_status_change_month: '',\n    aktueller_wochentag: '',\n    days_of_week: '',\n  }),\n  setup() {\n    \n    return { time }\n  },\n  async created() {\n    const counter = useCounterStore()\n    console.log(counter.count)\n    const {data: events} = await supabase\n      .from('events')\n      .select('description,name,status,time,last_status_change,days_of_week')\n      .eq('id', counter.count)\n    console.log(events)\n    this.spot = events\n    this.pre_reset()\n  },\n  methods: {\n    async presentActionSheet() {\n      const actionSheet = await actionSheetController\n        .create({\n          header: 'Status',\n          cssClass: 'my-custom-class',\n          buttons: [\n            {\n              text: 'Heute noch nicht besucht',\n              data: 10,  \n              handler: () => {\n                console.log('Share clicked')\n                this.changeStatus(1)\n              },\n            },\n            {\n              text: 'Für heute schon alles gerettet',\n              data: 'Data value',\n              handler: () => {\n                console.log('Play clicked')\n                this.changeStatus(2)\n              },\n            },\n            {\n              text: 'Hier gibts noch was',\n              handler: () => {\n                console.log('Favorite clicked')\n                this.changeStatus(3)\n              },\n            },\n            {\n              text: 'Abbrechen',\n              role: 'cancel',\n              handler: () => {\n                console.log('Abbrechen clicked')\n              },\n            },\n          ],\n        });\n      await actionSheet.present();\n\n      const { role, data } = await actionSheet.onDidDismiss();\n      console.log('onDidDismiss resolved with role and data', role, data);\n    },\n    async changeStatus(future_status) {\n        console.log(future_status)\n        const counter = useCounterStore()\n        const { data: error } = await supabase\n            .from('events')\n            .update({ status: future_status, last_status_change: new Date() })\n            .eq('id', counter.count )\n        console.log(error)\n        const {data: events} = await supabase\n            .from('events')\n            .select('description,name,status,last_status_change')\n            .eq('id', counter.count)\n        console.log(events)\n        this.spot = events\n    },\n    pre_reset() {\n      this.spot.forEach(element => {\n        this.reset(element.status, element.last_status_change, element.time)\n        this.days_of_week = element.days_of_week\n      });\n    },\n    reset(old_status, last_status_change, time) {\n        this.last_status_change = last_status_change\n        // const change_required = 0\n        if (old_status == 1) {\n          console.log('heute noch nicht besucht');\n        } else if (old_status == 2) {\n            this.time_since_close(time)\n        } else if (old_status == 3) {\n            this.time_since_close(time)\n        } else {\n            console.log('fehler. Der Wert ist nicht 1,2 oder 3');\n        }\n    },\n    time_since_close(time) {\n      console.log('time since close:')\n      // aktuelle Zeit:\n      this.heute = new Date();\n      const jetzt_hours = this.heute.getHours();\n      const jetzt_minutes = this.heute.getMinutes();\n      // Ladenschluss Zeit aufsplitten:\n      const time_split = time.split(':');\n      const time_hours = parseInt(time_split[0]);\n      const time_minutes = parseInt(time_split[1]);\n      // zeit in minuten\n      const time_total_minutes = (time_hours * 60) + time_minutes;\n      this.jetzt_total_minutes =(jetzt_hours * 60) + jetzt_minutes;\n      if (time_total_minutes > this.jetzt_total_minutes) {\n        this.time_since_close_value = 1440 - (time_total_minutes - this.jetzt_total_minutes)\n        console.log(this.time_since_close_value)\n        this.time_since_change()\n      }\n      else if (this.jetzt_total_minutes > time_total_minutes) {\n        this.time_since_close_value = this.jetzt_total_minutes - time_total_minutes\n        console.log(this.time_since_close_value)\n        this.time_since_change()\n      }\n      else if (time_total_minutes == this.jetzt_total_minutes) {\n        this.time_since_close_value = 0\n        console.log(this.time_since_close_value)\n        this.time_since_change()\n      }\n      else {\n        console.log('fehler')\n      }\n    },\n    // check_day() {\n    //   this.aktueller_wochentag = new Date().getDay()\n    //   console.log(this.aktueller_wochentag)\n    //   const day_to_check = this.days_of_week[this.aktueller_wochentag - 1]\n    //   const i\n    //   for (i = 7; i > 0; i--) {\n    //     if (day_to_check.isChecked == true) {\n    //       console.log('Heute hat der Laden offen')\n    //       //continue wihtout changes\n    //       this.time_since_change\n    //       // for abbrechen\n    //     } else if (day_to_check.isChecked == false) {\n    //       console.log('Der Laden hat heute geschlossen')\n    //       //Time_since_close_value um 1 Tag vergrößern\n          \n    //       this.time_since_close_value = this.time_since_close_value + (24 * 60)\n    //       //\n    //     } else {\n    //       console.log('fehler')\n    //     }\n    //   }\n    //   // this.time_since_change\n    // },\n    time_since_change() {\n      console.log('time since change:')\n      const last_status_change_local = new Date(Date.parse(this.last_status_change) + (120 * 60000))\n      this.time_since_change_value_millisec = Date.parse(this.heute) - Date.parse(last_status_change_local)\n      this.time_since_change_value_minutes = this.time_since_change_value_millisec / 60000\n      console.log(this.time_since_change_value_minutes)\n      this.time_since_change_vs_time_since_close()\n    },\n    time_since_change_vs_time_since_close() {\n      if (this.time_since_change_value_minutes < this.time_since_close_value) {\n        console.log('Letzte Statusänderung war nach dem letzten Ladenschluss. Wird ausgegeben wie in db')\n      } else if (this.time_since_close_value < this.time_since_change_value_minutes) {\n        console.log('Letzter Ladenschluss war nach der letzten Statusänderung Status wird geändert')\n        // ToDo\n        this.changeStatus(1)\n        console.log('Status wurde geändert')\n\n      } else {\n        console.log('Fehler')\n      }\n    },\n  }\n})\n</script>\n\n<style scoped>\n.card {\n    margin-top: 15px;\n}\n.time_chip {\n    /* position: relative; */\n    text-align: right;\n}\n.title {\n    margin-top: 10px;\n}\n.button {\n    margin-top: 20px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}